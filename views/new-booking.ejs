<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Tribook</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
        <link rel="stylesheet" href="/styles.css">
    </head>
  </head>
  <body>
    <h1>Añadir reserva de <strong><%= apartment.title %></strong></h1>
    <form class="w3-container" action="/apartment/new-booking" method="POST">
        <input type="hidden" name="idApartment" value="<%= apartment._id %>">
        <div class="w3-row">
            <label for="startDate">Fecha de inicio: </label>
            <input type="date" name="startDate" id="startDate">
        </div>
        <div class="w3-row" style="margin-top: 1rem;">
            <label for="endDate">Fecha de finalización: </label>
            <input type="date" name="endDate" id="endDate">
        </div>
        <input class="w3-btn w3-teal" type="submit" value="Añadir reserva">
    </form>
    <% if (typeof isBooked !== 'undefined') { %> 
        <% if (!isBooked) { %>
            <div id="message" class="container alert success">La reserva se ha realizado correctamente</div>
        <% } else { %> 
            <div id="message" class="container alert error">La reserva no puede realizarse en las fechas indicadas</div>
        <% } %> 
    <% } %>
    <script>
        // Get today's date
        const today = new Date();

        // Set start date to today
        const startDate = today.toISOString().split('T')[0];
        document.getElementById('startDate').value = startDate;

        // Calculate date 30 days from today
        const endDate = new Date();
        endDate.setDate(today.getDate() + 30);
        const formattedEndDate = endDate.toISOString().split('T')[0];

        // Set end date to 30 days later
        document.getElementById('endDate').value = formattedEndDate;
    </script>
  </body>
</html>